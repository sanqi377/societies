"use strict";
var ajaxHttp = function (url, data) {
    var token = wx.getStorageSync('token');
    return new Promise(function (resolve, reject) {
        wx.request({
            url: 'http://localhost:3000/index/' + url,
            method: 'POST',
            data: data,
            header: {
                token: token
            },
            success: function (res) {
                resolve(res);
            },
            fail: function (err) {
                reject(err);
            }
        });
    });
};
var checkLogin = function () {
    var token = wx.getStorageSync('token');
    if (!token)
        return false;
    return true;
};
var getFont = function () {
    return new Promise(function (resolve) {
        wx.loadFontFace({
            family: 'PingFang',
            source: 'url("http://localhost:3000/index/index/getFont")',
            success: function () {
                resolve(true);
            }
        });
    });
};
var formatMsgTime = function (timespan) {
    var dateTime = new Date(timespan);
    var year = dateTime.getFullYear();
    var month = dateTime.getMonth() + 1;
    var day = dateTime.getDate();
    var hour = dateTime.getHours();
    var minute = dateTime.getMinutes();
    var now_new = Date.parse((new Date()));
    var milliseconds = 0;
    var timeSpanStr;
    milliseconds = now_new - timespan;
    if (milliseconds <= 1000 * 60 * 1) {
        timeSpanStr = '刚刚';
    }
    else if (1000 * 60 * 1 < milliseconds && milliseconds <= 1000 * 60 * 60) {
        timeSpanStr = Math.round((milliseconds / (1000 * 60))) + '分钟前';
    }
    else if (1000 * 60 * 60 * 1 < milliseconds && milliseconds <= 1000 * 60 * 60 * 24) {
        timeSpanStr = Math.round(milliseconds / (1000 * 60 * 60)) + '小时前';
    }
    else if (1000 * 60 * 60 * 24 < milliseconds && milliseconds <= 1000 * 60 * 60 * 24 * 15) {
        timeSpanStr = Math.round(milliseconds / (1000 * 60 * 60 * 24)) + '天前';
    }
    else if (milliseconds > 1000 * 60 * 60 * 24 * 15 && year == new Date().getFullYear()) {
        timeSpanStr = month + '-' + day + ' ' + hour + ':' + minute;
    }
    else {
        timeSpanStr = year + '-' + month + '-' + day + ' ' + hour + ':' + minute;
    }
    return timeSpanStr;
};
module.exports = {
    ajax: ajaxHttp,
    checkLogin: checkLogin,
    getFont: getFont,
    formatMsgTime: formatMsgTime
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInV0aWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUtBLElBQUksUUFBUSxHQUFHLFVBQUMsR0FBVyxFQUFFLElBQVk7SUFDdkMsSUFBSSxLQUFLLEdBQUcsRUFBRSxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsQ0FBQTtJQUN0QyxPQUFPLElBQUksT0FBTyxDQUFDLFVBQUMsT0FBTyxFQUFFLE1BQU07UUFDakMsRUFBRSxDQUFDLE9BQU8sQ0FBQztZQUNULEdBQUcsRUFBRSw4QkFBOEIsR0FBRyxHQUFHO1lBQ3pDLE1BQU0sRUFBRSxNQUFNO1lBQ2QsSUFBSSxFQUFFLElBQUk7WUFDVixNQUFNLEVBQUU7Z0JBQ04sS0FBSyxPQUFBO2FBQ047WUFDRCxPQUFPLFlBQUMsR0FBRztnQkFDVCxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUE7WUFDZCxDQUFDO1lBQ0QsSUFBSSxFQUFFLFVBQUMsR0FBUTtnQkFDYixNQUFNLENBQUMsR0FBRyxDQUFDLENBQUE7WUFDYixDQUFDO1NBQ0YsQ0FBQyxDQUFBO0lBQ0osQ0FBQyxDQUFDLENBQUE7QUFDSixDQUFDLENBQUE7QUFNRCxJQUFJLFVBQVUsR0FBUTtJQUNwQixJQUFJLEtBQUssR0FBVyxFQUFFLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxDQUFBO0lBQzlDLElBQUksQ0FBQyxLQUFLO1FBQUUsT0FBTyxLQUFLLENBQUE7SUFDeEIsT0FBTyxJQUFJLENBQUE7QUFDYixDQUFDLENBQUE7QUFNRCxJQUFJLE9BQU8sR0FBRztJQUNaLE9BQU8sSUFBSSxPQUFPLENBQUMsVUFBQyxPQUFPO1FBQ3pCLEVBQUUsQ0FBQyxZQUFZLENBQUM7WUFDZCxNQUFNLEVBQUUsVUFBVTtZQUNsQixNQUFNLEVBQUUsa0RBQWtEO1lBQzFELE9BQU8sRUFBRTtnQkFDUCxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUE7WUFDZixDQUFDO1NBQ0YsQ0FBQyxDQUFBO0lBQ0osQ0FBQyxDQUFDLENBQUE7QUFDSixDQUFDLENBQUE7QUFFRCxJQUFJLGFBQWEsR0FBRyxVQUFDLFFBQWE7SUFFaEMsSUFBSSxRQUFRLEdBQUcsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUE7SUFFakMsSUFBSSxJQUFJLEdBQUcsUUFBUSxDQUFDLFdBQVcsRUFBRSxDQUFBO0lBQ2pDLElBQUksS0FBSyxHQUFHLFFBQVEsQ0FBQyxRQUFRLEVBQUUsR0FBRyxDQUFDLENBQUE7SUFDbkMsSUFBSSxHQUFHLEdBQUcsUUFBUSxDQUFDLE9BQU8sRUFBRSxDQUFBO0lBQzVCLElBQUksSUFBSSxHQUFHLFFBQVEsQ0FBQyxRQUFRLEVBQUUsQ0FBQTtJQUM5QixJQUFJLE1BQU0sR0FBRyxRQUFRLENBQUMsVUFBVSxFQUFFLENBQUE7SUFDbEMsSUFBSSxPQUFPLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksSUFBSSxFQUFFLENBQVEsQ0FBQyxDQUFBO0lBRTdDLElBQUksWUFBWSxHQUFHLENBQUMsQ0FBQTtJQUNwQixJQUFJLFdBQVcsQ0FBQTtJQUVmLFlBQVksR0FBRyxPQUFPLEdBQUcsUUFBUSxDQUFDO0lBRWxDLElBQUksWUFBWSxJQUFJLElBQUksR0FBRyxFQUFFLEdBQUcsQ0FBQyxFQUFFO1FBQ2pDLFdBQVcsR0FBRyxJQUFJLENBQUE7S0FDbkI7U0FDSSxJQUFJLElBQUksR0FBRyxFQUFFLEdBQUcsQ0FBQyxHQUFHLFlBQVksSUFBSSxZQUFZLElBQUksSUFBSSxHQUFHLEVBQUUsR0FBRyxFQUFFLEVBQUU7UUFDdkUsV0FBVyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxZQUFZLEdBQUcsQ0FBQyxJQUFJLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLEtBQUssQ0FBQTtLQUMvRDtTQUNJLElBQUksSUFBSSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxHQUFHLFlBQVksSUFBSSxZQUFZLElBQUksSUFBSSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxFQUFFO1FBQ2pGLFdBQVcsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFlBQVksR0FBRyxDQUFDLElBQUksR0FBRyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUE7S0FDbEU7U0FDSSxJQUFJLElBQUksR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxZQUFZLElBQUksWUFBWSxJQUFJLElBQUksR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEVBQUU7UUFDdkYsV0FBVyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsWUFBWSxHQUFHLENBQUMsSUFBSSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUE7S0FDdEU7U0FDSSxJQUFJLFlBQVksR0FBRyxJQUFJLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxJQUFJLElBQUksSUFBSSxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRSxFQUFFO1FBQ3BGLFdBQVcsR0FBRyxLQUFLLEdBQUcsR0FBRyxHQUFHLEdBQUcsR0FBRyxHQUFHLEdBQUcsSUFBSSxHQUFHLEdBQUcsR0FBRyxNQUFNLENBQUE7S0FDNUQ7U0FBTTtRQUNMLFdBQVcsR0FBRyxJQUFJLEdBQUcsR0FBRyxHQUFHLEtBQUssR0FBRyxHQUFHLEdBQUcsR0FBRyxHQUFHLEdBQUcsR0FBRyxJQUFJLEdBQUcsR0FBRyxHQUFHLE1BQU0sQ0FBQTtLQUN6RTtJQUNELE9BQU8sV0FBVyxDQUFBO0FBQ3BCLENBQUMsQ0FBQTtBQUVELE1BQU0sQ0FBQyxPQUFPLEdBQUc7SUFDZixJQUFJLEVBQUUsUUFBUTtJQUNkLFVBQVUsWUFBQTtJQUNWLE9BQU8sU0FBQTtJQUNQLGFBQWEsZUFBQTtDQUNkLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogd3gucmVxdWVzdCDlsIHoo4VcclxuICogQHBhcmFtIHVybCDor7fmsYIgdXJsXHJcbiAqIEBwYXJhbSBkYXRhIOivt+axguaVsOaNrlxyXG4gKi9cclxudmFyIGFqYXhIdHRwID0gKHVybDogc3RyaW5nLCBkYXRhOiBvYmplY3QpID0+IHtcclxuICBsZXQgdG9rZW4gPSB3eC5nZXRTdG9yYWdlU3luYygndG9rZW4nKVxyXG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICB3eC5yZXF1ZXN0KHtcclxuICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwL2luZGV4LycgKyB1cmwsXHJcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICBkYXRhOiBkYXRhLFxyXG4gICAgICBoZWFkZXI6IHtcclxuICAgICAgICB0b2tlblxyXG4gICAgICB9LFxyXG4gICAgICBzdWNjZXNzKHJlcykge1xyXG4gICAgICAgIHJlc29sdmUocmVzKVxyXG4gICAgICB9LFxyXG4gICAgICBmYWlsOiAoZXJyOiBhbnkpID0+IHtcclxuICAgICAgICByZWplY3QoZXJyKVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKiDmo4DmtYvmmK/lkKbnmbvlvZVcclxuICogQHJldHVybnMgXHJcbiAqL1xyXG52YXIgY2hlY2tMb2dpbjogYW55ID0gKCkgPT4ge1xyXG4gIHZhciB0b2tlbjogc3RyaW5nID0gd3guZ2V0U3RvcmFnZVN5bmMoJ3Rva2VuJylcclxuICBpZiAoIXRva2VuKSByZXR1cm4gZmFsc2VcclxuICByZXR1cm4gdHJ1ZVxyXG59XHJcblxyXG4vKipcclxuICog5Yqg6L29572R57uc5a2X5L2TXHJcbiAqIEByZXR1cm5zIFxyXG4gKi9cclxudmFyIGdldEZvbnQgPSAoKSA9PiB7XHJcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcbiAgICB3eC5sb2FkRm9udEZhY2Uoe1xyXG4gICAgICBmYW1pbHk6ICdQaW5nRmFuZycsXHJcbiAgICAgIHNvdXJjZTogJ3VybChcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9pbmRleC9pbmRleC9nZXRGb250XCIpJyxcclxuICAgICAgc3VjY2VzczogKCkgPT4ge1xyXG4gICAgICAgIHJlc29sdmUodHJ1ZSlcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9KVxyXG59XHJcblxyXG5sZXQgZm9ybWF0TXNnVGltZSA9ICh0aW1lc3BhbjogYW55KSA9PiB7XHJcblxyXG4gIHZhciBkYXRlVGltZSA9IG5ldyBEYXRlKHRpbWVzcGFuKVxyXG5cclxuICB2YXIgeWVhciA9IGRhdGVUaW1lLmdldEZ1bGxZZWFyKClcclxuICB2YXIgbW9udGggPSBkYXRlVGltZS5nZXRNb250aCgpICsgMVxyXG4gIHZhciBkYXkgPSBkYXRlVGltZS5nZXREYXRlKClcclxuICB2YXIgaG91ciA9IGRhdGVUaW1lLmdldEhvdXJzKClcclxuICB2YXIgbWludXRlID0gZGF0ZVRpbWUuZ2V0TWludXRlcygpXHJcbiAgdmFyIG5vd19uZXcgPSBEYXRlLnBhcnNlKChuZXcgRGF0ZSgpKSBhcyBhbnkpXHJcblxyXG4gIHZhciBtaWxsaXNlY29uZHMgPSAwXHJcbiAgdmFyIHRpbWVTcGFuU3RyXHJcblxyXG4gIG1pbGxpc2Vjb25kcyA9IG5vd19uZXcgLSB0aW1lc3BhbjtcclxuXHJcbiAgaWYgKG1pbGxpc2Vjb25kcyA8PSAxMDAwICogNjAgKiAxKSB7XHJcbiAgICB0aW1lU3BhblN0ciA9ICfliJrliJonXHJcbiAgfVxyXG4gIGVsc2UgaWYgKDEwMDAgKiA2MCAqIDEgPCBtaWxsaXNlY29uZHMgJiYgbWlsbGlzZWNvbmRzIDw9IDEwMDAgKiA2MCAqIDYwKSB7XHJcbiAgICB0aW1lU3BhblN0ciA9IE1hdGgucm91bmQoKG1pbGxpc2Vjb25kcyAvICgxMDAwICogNjApKSkgKyAn5YiG6ZKf5YmNJ1xyXG4gIH1cclxuICBlbHNlIGlmICgxMDAwICogNjAgKiA2MCAqIDEgPCBtaWxsaXNlY29uZHMgJiYgbWlsbGlzZWNvbmRzIDw9IDEwMDAgKiA2MCAqIDYwICogMjQpIHtcclxuICAgIHRpbWVTcGFuU3RyID0gTWF0aC5yb3VuZChtaWxsaXNlY29uZHMgLyAoMTAwMCAqIDYwICogNjApKSArICflsI/ml7bliY0nXHJcbiAgfVxyXG4gIGVsc2UgaWYgKDEwMDAgKiA2MCAqIDYwICogMjQgPCBtaWxsaXNlY29uZHMgJiYgbWlsbGlzZWNvbmRzIDw9IDEwMDAgKiA2MCAqIDYwICogMjQgKiAxNSkge1xyXG4gICAgdGltZVNwYW5TdHIgPSBNYXRoLnJvdW5kKG1pbGxpc2Vjb25kcyAvICgxMDAwICogNjAgKiA2MCAqIDI0KSkgKyAn5aSp5YmNJ1xyXG4gIH1cclxuICBlbHNlIGlmIChtaWxsaXNlY29uZHMgPiAxMDAwICogNjAgKiA2MCAqIDI0ICogMTUgJiYgeWVhciA9PSBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCkpIHtcclxuICAgIHRpbWVTcGFuU3RyID0gbW9udGggKyAnLScgKyBkYXkgKyAnICcgKyBob3VyICsgJzonICsgbWludXRlXHJcbiAgfSBlbHNlIHtcclxuICAgIHRpbWVTcGFuU3RyID0geWVhciArICctJyArIG1vbnRoICsgJy0nICsgZGF5ICsgJyAnICsgaG91ciArICc6JyArIG1pbnV0ZVxyXG4gIH1cclxuICByZXR1cm4gdGltZVNwYW5TdHJcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgYWpheDogYWpheEh0dHAsXHJcbiAgY2hlY2tMb2dpbixcclxuICBnZXRGb250LFxyXG4gIGZvcm1hdE1zZ1RpbWVcclxufSJdfQ==