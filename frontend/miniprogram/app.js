"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var io = wx.connectSocket({
    url: 'ws://127.0.0.1:3001',
    success: function () {
        console.log('socket 连接成功');
    }
});
var hostId = 0;
App({
    globalData: {
        io: io,
        monitor: function (callback) {
            io.onMessage(function (res) {
                callback(res.data);
            });
        },
        wlecome: function (info) {
            io.send({
                data: JSON.stringify(info),
                success: function () {
                    hostId = info.send;
                    console.log("\u7ED1\u5B9A\u4E3B\u673A\u4FE1\u606F\u6210\u529F\uFF1A\u4E3B\u673A\u53F7\u4E3A" + info.send);
                }
            });
        }
    },
    onLaunch: function () {
        wx.onSocketOpen(function () {
            console.log('监听到 WebSocket 连接已打开！');
        });
        io.onOpen(function () {
            console.log('连接打开成功');
        });
    },
    onHide: function () {
        io.send({
            data: JSON.stringify({ type: 'offLine', hostId: hostId }),
            success: function () {
                io.close({});
                console.log("\u4E3B\u673A\u4E0B\u7EBF\u6210\u529F\uFF1A\u4E3B\u673A\u53F7\u4E3A" + hostId);
            }
        });
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiYXBwLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0EsSUFBSSxFQUFFLEdBQUcsRUFBRSxDQUFDLGFBQWEsQ0FBQztJQUN4QixHQUFHLEVBQUUscUJBQXFCO0lBQzFCLE9BQU8sRUFBRTtRQUNQLE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDLENBQUE7SUFDNUIsQ0FBQztDQUNGLENBQUMsQ0FBQTtBQUVGLElBQUksTUFBTSxHQUFHLENBQUMsQ0FBQTtBQUVkLEdBQUcsQ0FBYTtJQUNkLFVBQVUsRUFBRTtRQUNWLEVBQUUsSUFBQTtRQUNGLE9BQU8sRUFBUCxVQUFRLFFBQWE7WUFDbkIsRUFBRSxDQUFDLFNBQVMsQ0FBQyxVQUFBLEdBQUc7Z0JBQ2QsUUFBUSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQTtZQUNwQixDQUFDLENBQUMsQ0FBQTtRQUNKLENBQUM7UUFDRCxPQUFPLEVBQVAsVUFBUSxJQUFTO1lBQ2YsRUFBRSxDQUFDLElBQUksQ0FBQztnQkFDTixJQUFJLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUM7Z0JBQzFCLE9BQU8sRUFBRTtvQkFDUCxNQUFNLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQTtvQkFDbEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxtRkFBZ0IsSUFBSSxDQUFDLElBQU0sQ0FBQyxDQUFBO2dCQUMxQyxDQUFDO2FBQ0YsQ0FBQyxDQUFBO1FBQ0osQ0FBQztLQUNGO0lBQ0QsUUFBUTtRQUNOLEVBQUUsQ0FBQyxZQUFZLENBQUM7WUFDZCxPQUFPLENBQUMsR0FBRyxDQUFDLHNCQUFzQixDQUFDLENBQUM7UUFDdEMsQ0FBQyxDQUFDLENBQUE7UUFFRixFQUFFLENBQUMsTUFBTSxDQUFDO1lBQ1IsT0FBTyxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUN4QixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFDRCxNQUFNO1FBQ0osRUFBRSxDQUFDLElBQUksQ0FBQztZQUNOLElBQUksRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxNQUFNLFFBQUEsRUFBRSxDQUFDO1lBQ2pELE9BQU8sRUFBRTtnQkFDUCxFQUFFLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFBO2dCQUNaLE9BQU8sQ0FBQyxHQUFHLENBQUMsdUVBQWMsTUFBUSxDQUFDLENBQUE7WUFDckMsQ0FBQztTQUNGLENBQUMsQ0FBQTtJQUNKLENBQUM7Q0FDRixDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgeyB9XHJcbmxldCBpbyA9IHd4LmNvbm5lY3RTb2NrZXQoe1xyXG4gIHVybDogJ3dzOi8vMTI3LjAuMC4xOjMwMDEnLFxyXG4gIHN1Y2Nlc3M6ICgpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKCdzb2NrZXQg6L+e5o6l5oiQ5YqfJylcclxuICB9XHJcbn0pXHJcblxyXG5sZXQgaG9zdElkID0gMFxyXG5cclxuQXBwPElBcHBPcHRpb24+KHtcclxuICBnbG9iYWxEYXRhOiB7XHJcbiAgICBpbyxcclxuICAgIG1vbml0b3IoY2FsbGJhY2s6IGFueSkge1xyXG4gICAgICBpby5vbk1lc3NhZ2UocmVzID0+IHtcclxuICAgICAgICBjYWxsYmFjayhyZXMuZGF0YSlcclxuICAgICAgfSlcclxuICAgIH0sXHJcbiAgICB3bGVjb21lKGluZm86IGFueSkge1xyXG4gICAgICBpby5zZW5kKHtcclxuICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeShpbmZvKSxcclxuICAgICAgICBzdWNjZXNzOiAoKSA9PiB7XHJcbiAgICAgICAgICBob3N0SWQgPSBpbmZvLnNlbmRcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGDnu5HlrprkuLvmnLrkv6Hmga/miJDlip/vvJrkuLvmnLrlj7fkuLoke2luZm8uc2VuZH1gKVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgIH1cclxuICB9LFxyXG4gIG9uTGF1bmNoKCkge1xyXG4gICAgd3gub25Tb2NrZXRPcGVuKCgpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coJ+ebkeWQrOWIsCBXZWJTb2NrZXQg6L+e5o6l5bey5omT5byA77yBJyk7XHJcbiAgICB9KVxyXG5cclxuICAgIGlvLm9uT3BlbigoKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfov57mjqXmiZPlvIDmiJDlip8nKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcbiAgb25IaWRlKCkge1xyXG4gICAgaW8uc2VuZCh7XHJcbiAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHsgdHlwZTogJ29mZkxpbmUnLCBob3N0SWQgfSksXHJcbiAgICAgIHN1Y2Nlc3M6ICgpID0+IHtcclxuICAgICAgICBpby5jbG9zZSh7fSlcclxuICAgICAgICBjb25zb2xlLmxvZyhg5Li75py65LiL57q/5oiQ5Yqf77ya5Li75py65Y+35Li6JHtob3N0SWR9YClcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9XHJcbn0pIl19